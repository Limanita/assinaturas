<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Assinatura Din√¢mica</title>

  <!-- Fontes -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;600&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Mulish', sans-serif; padding: 20px; }
    select { padding: 8px; margin-bottom: 20px; }
    #assinatura table { font-size: 14px; color: #3d3d3d; }
    .contatos { display: flex; flex-direction: column; gap: 4px; margin-top: 16px; margin-right: 8px; }
    .linha-contato { line-height: 20px; font-size: 14px; color: #3d3d3d; }
    .linha-contato a { line-height: 20px; none; color: inherit; }
    button { margin-top: 16px; padding: 8px 12px; font-size: 14px; cursor: pointer; }

    /* Borda apenas para visualiza√ß√£o, n√£o copiada pelo script */
    #assinatura {
    border: 2px solid #055441;
    padding: 12px;
    display: inline-block;
    }


    /* Estilos para se√ß√£o de instru√ß√µes */
    #instrucoes-uso {
      margin-top: 40px;
      font-size: 14px;
      color: #3d3d3d;
    }
     #instrucoes-uso h1 {
      font-size: 24px;
      margin-bottom: 12px;
      color: #055441;
    }
    #instrucoes-uso h2 {
      font-size: 18px;
      margin-bottom: 12px;
      color: #055441;
    }
    #instrucoes-uso ol {
      padding-left: 20px;
    }
    #instrucoes-uso li {
      margin-bottom: 12px;
      line-height: 1.5;
    }
    #instrucoes-uso img {
      max-width: 100%;
      display: block;
      margin: 8px 0;
    }
  </style>
</head>
<body>

  <div id="cabecalho-pagina" style="text-align: right; padding: 10px; font-family: 'Mulish', sans-serif; font-weight: 300; color: #055441;font-size: 10px">
    Desenvolvido por <br>
    DAT Aprender Editora
    
  </div>
  <div id="instrucoes-uso">
    <h1>Gere e copie sua assinatura</h1>
</div>
    <hr style="border: 0.5px solid #055441; margin-top: 8px;">
  <select id="usuarios">

    <option value="">Selecione seu nome</option>
  </select><br>

  <div id="assinatura"></div><br>
  <button id="copyBtn" style="display: none;">Copiar assinatura</button>

  <!-- Se√ß√£o de Instru√ß√µes de Uso (extra√≠da de Instru√ß√µes Assinaturas.rtf) -->
  <div id="instrucoes-uso">
    <h2>Instru√ß√µes de Uso</h2>
    <p>Agora, voc√™ ir√° realizar a inclus√£o da assinatura no seu Gmail. Para executar os procedimentos corretamente, <strong>acesse atrav√©s de um computador.</strong></p>
    <ol>
      <li>
        Abra o navegador e acesse <a href="https://mail.google.com" target="_blank" rel="noopener">gmail.com</a>.<br>
        Fa√ßa login informando seu e‚Äëmail e senha.
        <!--<img src="" alt="Login no Gmail">-->
      </li>
      <li>
        Com a conta aberta, clique no √≠cone de <strong>configura√ß√µes</strong>. Representado pela engrenagem
        <img src="https://raw.githubusercontent.com/Limanita/assinaturas-img/9e2ae324deea284283471169df2a202fd3e92896/config_google.png" alt="√çcone de configura√ß√µes">
      </li>
      <li>
        Na aba que se abriu, clique em <strong>Mostrar todas as configura√ß√µes</strong>.<br>
          <img src="https://raw.githubusercontent.com/Limanita/assinaturas-img/9e2ae324deea284283471169df2a202fd3e92896/show_all_config.png" alt="Criar nova assinatura"> 
      </li>
      <li>
          Role at√© a se√ß√£o <strong>Assinaturas</strong> e clique em ‚ÄúCriar novo‚Äù para adicionar uma nova assinatura.
        <img src="https://raw.githubusercontent.com/Limanita/assinaturas-img/9e2ae324deea284283471169df2a202fd3e92896/new_assi.png" alt="Criar nova assinatura"> 
      </li>
      <li>
        Na janela, digite <strong>APRENDER</strong> no campo de nome da assinatura e clique em <strong>Criar</strong>.
        <img src="https://raw.githubusercontent.com/Limanita/assinaturas-img/9e2ae324deea284283471169df2a202fd3e92896/name.png" alt="Nome da assinatura">
      </li>
      <li>
        Cole a assinatura que voc√™ copiou (clique dentro da √°rea de texto e pressione Ctrl¬†+¬†V).
        <img src="https://raw.githubusercontent.com/Limanita/assinaturas-img/9e2ae324deea284283471169df2a202fd3e92896/colar_assi.png" alt="Colar assinatura">
      </li>
      <li>
        Logo abaixo, em <strong>Padr√µes de assinatura</strong>, selecione a assinatura ‚ÄúAPRENDER‚Äù tanto para novos e‚Äëmails quanto para respostas/encaminhamentos.
        <img src="https://raw.githubusercontent.com/Limanita/assinaturas-img/9e2ae324deea284283471169df2a202fd3e92896/select_ass.png" alt="Padr√µes de assinatura">
      </li>
      <li>
        Role at√© o final da p√°gina e clique em <strong>Salvar altera√ß√µes</strong>.
        <img src="https://raw.githubusercontent.com/Limanita/assinaturas-img/refs/heads/main/save.png" alt="Salvar altera√ß√µes">
      </li>
      </ol>
      </div>
      <h2><strong>Pronto! Sua assinatura de e‚Äëmail foi configurada com sucesso.</strong></h2>

  <script>
    // 1) busca usu√°rios
    fetch('https://sheetdb.io/api/v1/r1fdev7zzdqko')
      .then(res => res.json())
      .then(data => {
        const sel = document.getElementById('usuarios');
        data.forEach(user => {
          const opt = document.createElement('option');
          opt.value = user.Nome;
          opt.textContent = user.Nome;
          opt.dataset.info = JSON.stringify(user);
          sel.appendChild(opt);
        });

        sel.addEventListener('change', function() {
          const info = JSON.parse(this.selectedOptions[0].dataset.info);
          const telefone = info.Telefone || '85 3194-1300';
          const celular  = info.Celular  || '';
          const email    = info.Email    || '';
          const site     = 'aprendereditora.com.br';

          const html = `
            <table width="580" border="0" cellpadding="0" cellspacing="0" style="font-family: 'Mulish', Helvetica, Arial, sans-serif; margin: 0; background-image: url('https://i.imgur.com/x4qUx1g.png'); background-size: cover; background-position: center; background-repeat: no-repeat; background-color: #ffffff; color: #333333; border-radius: 8px; border: 1px solid #cccccc;">
                <tr>
                    <td style="padding: 16px 16px;">
                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                            <tr>
                                <td width="180" style="vertical-align: middle; padding-right: 10px; text-align: center;">
                                    <a href="https://${site}" target="_blank" style="text-decoration: none;">
                                        <img src="https://i.imgur.com/MxiCNJF.gif" alt="Aprender Editora" width="200" style="display: block; margin: 0 auto 8px auto; border: 0;">
                                    </a>
                                    
                                    <a href="https://${site}" style="color: #055441; align-items: center; text-decoration: none; font-size: 12px; display: block; margin-bottom: 8px; font-weight: 600; letter-spacing: 0.5px;">
                                        üåê ${site}
                                    </a>

                                    <table border="0" cellpadding="0" cellspacing="0" style="margin: 0 auto;">
                                        <tr>
                                            <td style="padding: 0 4px;">
                                                <a href="https://www.instagram.com/aprendereditora" style="text-decoration:none;">
                                                    <img src="https://i.imgur.com/wTeSRVM.png" width="24" style="display: block; border-radius: 50%;">
                                                </a>
                                            </td>
                                            <td style="padding: 0 4px;">
                                                <a href="https://www.facebook.com/AprenderEditora" style="text-decoration:none;">
                                                    <img src="https://i.imgur.com/6NDTGPO.png" width="24" style="display: block; border-radius: 50%;">
                                                </a>
                                            </td>
                                            <td style="padding: 0 4px;">
                                                <a href="https://x.com/aprendereditora" style="text-decoration:none;">
                                                    <img src="https://i.imgur.com/YusA8k3.png" width="24" style="display: block; border-radius: 50%;">
                                                </a>
                                            </td>
                                        </tr>
                                    </table>
                                </td>

                                <td width="1" style="background-color: #055441; opacity: 0.3; font-size: 1px; line-height: 1px;">&nbsp;</td>

                                <td width="380" style="vertical-align: middle; padding-left: 20px;">
                                    <div style="margin-bottom: 18px;">
                                        <h1 style="margin: 0; font-size: 22px; color: #055441; font-weight: 800; letter-spacing: 0.5px; line-height: 1.2; text-transform: uppercase;">${info.Nome}</h1>
                                        <p style="margin: 4px 0 0 0; font-size: 13px; color: #1a7a60; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;">
                                            ${info.Cargo}
                                        </p>
                                        ${info.Setor ? `<p style="margin: 2px 0 0 0; font-size: 11px; color: #555555; opacity: 0.9;">${info.Setor}</p>` : ''}
                                    </div>
                                    
                                    <table border="0" cellpadding="0" cellspacing="0" style="font-size: 13px; color: #333333;">
                                        <tr>
                                            <td width="22" style="vertical-align: middle; padding-bottom: 6px;">
                                                <span style="font-size: 16px;">‚úâÔ∏è</span>
                                            </td>
                                            <td style="vertical-align: middle; padding-bottom: 6px;">
                                                <a href="mailto:${email}" style="color: #333333; text-decoration: none; border-bottom: 1px dotted #055441;">${email}</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td width="22" style="vertical-align: middle; padding-bottom: 6px;">
                                                <span style="font-size: 16px;">üìû</span>
                                            </td>
                                            <td style="vertical-align: middle; padding-bottom: 6px;">
                                                <a href="tel:${telefone.replace(/[^+\d]/g,'')}" style="color: #333333; text-decoration: none;">${telefone}</a>
                                                ${celular ? ` <span style="opacity:0.6">|</span> <a href="tel:${celular.replace(/[^+\d]/g,'')}" style="color: #333333; text-decoration: none;">${celular}</a>` : ''}
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
          `;

          document.getElementById('assinatura').innerHTML = html;
          document.getElementById('copyBtn').style.display = 'inline-block';
        });
      });

    // 2) c√≥pia rich-text para clipboard
    document.getElementById('copyBtn').addEventListener('click', async () => {
      const container = document.getElementById('assinatura');
      const html = container.innerHTML;
      const text = container.innerText;

      if (navigator.clipboard && navigator.clipboard.write) {
        try {
          const blobHtml = new Blob([html], { type: 'text/html' });
          const blobText = new Blob([text], { type: 'text/plain' });
          await navigator.clipboard.write([
            new ClipboardItem({ 'text/html': blobHtml, 'text/plain': blobText })
          ]);
          alert('Assinatura copiada como rich text! Cole no Gmail.');
          return;
        } catch (e) {
          console.warn('Clipboard API falhou, efetuando fallback');
        }
      }

      // fallback
      const range = document.createRange();
      range.selectNode(container);
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      document.execCommand('copy');
      sel.removeAllRanges();
      alert('Assinatura copiada! Cole no Gmail.');
    });
  </script>
</body>
</html>

